<!DOCTYPE html>
<html>
<head>
<title>MAGITECH BB</title>
<style>
body{background:#0b1f14;color:#3aff7a;font-family:monospace}
.green{color:#3aff7a}.blue{color:#2fd0ff}.orange{color:#ff9a2f}
</style>
</head>
<body>

<h1>MAGITECH BB</h1>
<div id="forum"></div>

<textarea id="anon"></textarea><br>
<button onclick="postAnon()">Post Anon</button>

<hr>

<input id="u" placeholder="user">
<input id="p" type="password" placeholder="pass">
<button onclick="login()">Login</button>

<p>
<a href="inbox.html">ðŸ“¨ Inbox</a> |
<a href="logs.html">ðŸ“œ Logs</a> |
<a href="admin.html">âš  Admin</a>
</p>

<script>
function load(){
  fetch("/forum").then(r=>r.json()).then(d=>{
    forum.innerHTML="";
    d.forEach(p=>{
      forum.innerHTML+=`<div class="${p.color}">[${p.author}] ${p.text}</div>`;
    });
  });
}

function postAnon(){
  fetch("/forum/anon",{method:"POST",headers:{'Content-Type':'application/json'},
  body:JSON.stringify({text:anon.value})}).then(load);
  anon.value="";
}

function login(){
  fetch("/login",{method:"POST",headers:{'Content-Type':'application/json'},
  body:JSON.stringify({username:u.value,password:p.value})})
  .then(r=>r.json()).then(d=>{
    if(d.error) alert(d.error);
    else localStorage.setItem("session",JSON.stringify(d));
  });
}

load();
</script>
</body>
</html>
